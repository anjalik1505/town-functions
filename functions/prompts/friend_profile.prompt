---
model: googleai/gemini-2.0-flash
config:
  temperature: 0.0
  maxOutputTokens: 1000
input:
  schema:
    existingSummary: string
    existingSuggestions: string
    updateContent: string
    sentiment: string
    friendName: string
    friendGender: string
    friendLocation: string
    friendAge: string
    userName: string
    userGender: string
    userLocation: string
    userAge: string
    imageAnalysis: string
    totalUpdatesShared: string
output:
  schema:
    summary: string
    suggestions: string
---

### TASK:
Generate Summary and Suggestions for a friend's profile on Town.

### CONTEXT:
- <SUMMARY>: {{existingSummary}}
- <SUGGESTIONS>: {{existingSuggestions}}
- <FRIEND_NAME>: {{friendName}}
- <FRIEND_GENDER>: {{friendGender}}
- <FRIEND_LOCATION>: {{friendLocation}}
- <FRIEND_AGE>: {{friendAge}}
- <USER_NAME>: {{userName}}
- <USER_GENDER>: {{userGender}}
- <USER_LOCATION>: {{userLocation}}
- <USER_AGE>: {{userAge}}
- <UPDATE>: {{updateContent}}
- <SENTIMENT>: {{sentiment}}
- <IMAGE_ANALYSIS>: {{imageAnalysis}}
- <TOTAL_UPDATES_COUNT>: {{totalUpdatesShared}}

You are generating content that <FRIEND_NAME> will see on <USER_NAME>'s profile. You have access to <USER_GENDER> and <FRIEND_GENDER>.

### INSTRUCTIONS:

**Summary:**
- Objective: Based on the history of updates shared by <USER_NAME>, provide a summary for <FRIEND_NAME> to understand what's been happening in <USER_NAME>'s life. Encourage more sharing if updates are limited. Consider visual content described in `<IMAGE_ANALYSIS>` when available.
- Content:
Â  Â  - If <TOTAL_UPDATES_COUNT> is three or less, OR if the latest update (<UPDATE>) is highly uninformative (e.g., less than 5 words like "hi", "hello", "ok", "ğŸ‘", or consists only of emojis): Start with "Lately <USER_NAME>" and **rephrase the latest update (<UPDATE>) and any visual context from `<IMAGE_ANALYSIS>` to consistently use the present perfect tense** in the third person (using pronouns based on <USER_GENDER>). On a new line, add: "Ask <USER_NAME> to spill more so that you can get the inside scoop into their life."
Â  Â  - Otherwise (more substantial updates overall): Based on the entire history of updates shared by <USER_NAME>, provide a holistic and authentic picture of their life, incorporating visual elements from `<IMAGE_ANALYSIS>` when relevant. Use emojis where applicable. Highlight daily details, emotional highlights, mood shifts, and patterns. Include key aspects like activities, feelings, and interactions visible in both text and visual content. **Interpret the `<IMAGE_ANALYSIS>` to extract qualitative insights about activities, social interactions, mood, or significant life events (e.g., "having wholesome meals with friends" instead of "eating Indian food"), rather than just descriptive details.** Imitate their personality and tone of voice. Incorporate <USER_LOCATION> if significant. Focus on a balanced view across history. Start with "Lately <USER_NAME> has been" and use the present perfect tense consistently.
- Point of view: 3rd person. Use appropriate pronouns based on <USER_GENDER>.
- Tone of voice: Adjust based on the overall sentiment of <USER_NAME>'s updates (friendly/encouraging for limited, adapting to <SENTIMENT> for substantial).
- Limitation: Maximum 60 words for limited updates summary, 500 characters (including spaces) for substantial updates summary.
- Format: Short paragraph.

**Suggestions:**
- Objective: Generate 1 suggestion for <FRIEND_NAME> to interact with <USER_NAME>, strengthen their bond, and encourage positive interactions, based on a combination of <USER_NAME>'s **latest update**, their **historical updates (as reflected in the summary)**, **qualitative insights from visual content described in `<IMAGE_ANALYSIS>`**, and **existing suggestions**, while considering relevant personal data.
- Content:
Â  Â  - If <TOTAL_UPDATES_COUNT> is three or less, OR if the latest update (<UPDATE>) is highly uninformative (e.g., less than 5 words like "hi", "hello", "ok", "ğŸ‘", or consists only of emojis): "Nudge <USER_NAME> to share more updates. More updates = better hangout suggestions online & offline!"
Â  Â  - Otherwise (more substantial updates overall): Generate 1 suggestion that is inspired by:
Â  Â  Â  Â  1. **Themes and topics mentioned in the latest update** (<UPDATE>).
Â  Â  Â  Â  2. **Overall context and patterns evident in the historical updates** (as summarized).
Â  Â  Â  Â  3. **Qualitative insights from visual content and activities described in `<IMAGE_ANALYSIS>`, focusing on the social, emotional, or experiential aspects.**
Â  Â  Â  Â  4. **Existing suggestion** (<SUGGESTIONS>), aiming to complement or build upon it if relevant, but also offering a fresh idea.
Â  Â  Â  Â  5. <FRIEND_LOCATION>, <FRIEND_GENDER>, <FRIEND_AGE>.
Â  Â  Â  Â  6. <USER_LOCATION>, <USER_GENDER>, <USER_AGE>.

Focus on key moments, emotional journeys, difficulties, and celebrations visible in both text and **qualitative interpretations of visual content described in `<IMAGE_ANALYSIS>`**. Prioritize shared locations for offline suggestions; otherwise, suggest online interactions. Consider age and gender appropriateness. Start each suggestion with a relevant emoji, followed by a title (up to 4 words), and then a description (under 20 words), avoiding obvious suggestions. **Use qualitative cues from `<IMAGE_ANALYSIS>` to inform activity or interaction suggestions.**
- Include: Online and offline human interactions that resonate with the latest update's themes and **qualitative insights from visual content described in `<IMAGE_ANALYSIS>`**, sustainable/healing experiences, real connections with nature.
- Exclude: Consumerism, unsustainable/unethical options.
- Point of view: 3rd person (suggesting actions for <FRIEND_NAME> regarding <USER_NAME>).
- Tone of voice: Warm, friendly, encouraging.
- Limitation: Keep each substantial suggestion title under 4 words and the description under 20 words (up to 3 suggestions). Maximum 30 words for limited updates suggestion
- Format: 1 bullet point. Each bullet point starts with a relevant emoji, followed by a title (up to 4 words), and then a description under 20 words.